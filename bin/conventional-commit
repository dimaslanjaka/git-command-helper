#!/usr/bin/env node

// refactor/feat/chore/fix "header" "line2" "line3"
// refactor/feat/chore/fix -s scopename "header" "line2" "line3"
// refactor/feat/chore/fix -s scopename "message \`code\` another message"

const cp = require('cross-spawn');
const minimist = require('minimist');
const argv = minimist(process.argv.slice(2));
/** scoped commit */
const scope = argv['s'] || argv['scope'];
/** refactor/feat/chore/fix */
const type = argv['t'] || argv['type'];

const messages = [];
if (scope) {
  messages.push(`${type}(${scope}): ${argv._[0]}`, ...argv._.slice(1));
} else {
  messages.push(`${type}: ${argv._[0]}`, ...argv._.slice(1));
}

const args = ['commit'];
for (let i = 0; i < messages.length; i++) {
  const msg = messages[i];
  args.push('-m', `${msg}`);
}

cp.sync('git', args, { cwd: process.cwd() });
